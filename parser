# Add SAN extension for multiple seed nodes
$sanBuilder = New-Object -ComObject X509Enrollment.CX509ExtensionAlternativeNames
$altNames = New-Object -ComObject X509Enrollment.CAlternativeNames

$san1 = New-Object -ComObject X509Enrollment.CAlternativeName
$san1.InitializeFromString(0x3, "192.168.1.10")
$altNames.Add($san1)

$san2 = New-Object -ComObject X509Enrollment.CAlternativeName
$san2.InitializeFromString(0x3, "192.168.1.11")
$altNames.Add($san2)

$sanBuilder.InitializeEncode($altNames)
$cert.X509Extensions.Add($sanBuilder)
